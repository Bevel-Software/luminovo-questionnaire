<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Backend Test - Luminovo Questionnaire</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-card {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .status {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 4px;
            font-size: 14px;
            font-weight: 600;
        }
        .status.ok { background: #d4edda; color: #155724; }
        .status.error { background: #f8d7da; color: #721c24; }
        .status.pending { background: #fff3cd; color: #856404; }
        pre {
            background: #f8f9fa;
            padding: 12px;
            border-radius: 4px;
            overflow-x: auto;
        }
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
        }
        button:hover { background: #0056b3; }
        button:disabled { background: #6c757d; cursor: not-allowed; }
    </style>
</head>
<body>
    <h1>ðŸ§ª Backend Test Suite</h1>
    
    <div class="test-card">
        <h2>Server Health Check</h2>
        <p>Testing if the backend server is running and Supabase is connected.</p>
        <button id="healthBtn" onclick="testHealth()">Run Health Check</button>
        <div id="healthResult"></div>
    </div>

    <div class="test-card">
        <h2>Frontend Access</h2>
        <p>Your existing frontend should still work:</p>
        <ul>
            <li><a href="/" target="_blank">Main App (English)</a></li>
            <li><a href="/de/" target="_blank">German Version</a></li>
        </ul>
    </div>

    <div class="test-card">
        <h2>Setup Instructions</h2>
        <ol>
            <li>Copy <code>.env.example</code> to <code>.env</code></li>
            <li>Add your Supabase credentials to <code>.env</code></li>
            <li>Run <code>npm install</code> to install dependencies</li>
            <li>Run <code>npm run migrate</code> to see the SQL migration</li>
            <li>Copy the SQL and run it in Supabase SQL Editor</li>
            <li>Run <code>npm run dev</code> to start the server</li>
        </ol>
    </div>

    <script>
        async function testHealth() {
            const btn = document.getElementById('healthBtn');
            const result = document.getElementById('healthResult');
            
            btn.disabled = true;
            result.innerHTML = '<p class="status pending">Testing...</p>';
            
            try {
                const response = await fetch('/api/health');
                const data = await response.json();
                
                const statusClass = data.status === 'ok' ? 'ok' : 'error';
                const dbStatus = data.database === 'connected' ? 'ok' : 'error';
                
                result.innerHTML = `
                    <p><span class="status ${statusClass}">Server: ${data.status}</span></p>
                    <p><span class="status ${dbStatus}">Database: ${data.database || 'unknown'}</span></p>
                    <pre>${JSON.stringify(data, null, 2)}</pre>
                `;
            } catch (error) {
                result.innerHTML = `
                    <p><span class="status error">Connection Failed</span></p>
                    <pre>${error.message}</pre>
                    <p>Make sure the server is running with <code>npm run dev</code></p>
                `;
            } finally {
                btn.disabled = false;
            }
        }
    </script>
</body>
</html>
